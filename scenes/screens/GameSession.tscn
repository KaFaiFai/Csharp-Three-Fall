[gd_scene load_steps=11 format=3 uid="uid://dhx47vi00y3el"]

[ext_resource type="Script" path="res://scenes/screens/GameSession.cs" id="1_8dl8f"]
[ext_resource type="PackedScene" uid="uid://bjmrato4y1a8w" path="res://scenes/components/InputEvents.tscn" id="2_a1hox"]
[ext_resource type="Script" path="res://scenes/screens/PlayerStateMachine.cs" id="3_3ufha"]
[ext_resource type="Script" path="res://scenes/screens/PlayerInputState.cs" id="4_7jlcv"]
[ext_resource type="Script" path="res://scenes/screens/PlayerPlacingState.cs" id="5_dobk6"]
[ext_resource type="Script" path="res://scenes/screens/PlayerGameOverState.cs" id="6_0tcjc"]
[ext_resource type="Script" path="res://scenes/screens/PlayerStartState.cs" id="7_d3pe8"]
[ext_resource type="PackedScene" uid="uid://b12i7atr4i8gu" path="res://scenes/Polyomino.tscn" id="8_giipe"]
[ext_resource type="PackedScene" uid="uid://ckhwuulfvwjse" path="res://scenes/BlockBoard.tscn" id="9_0x3v3"]
[ext_resource type="PackedScene" uid="uid://dwrsnq6e6cm26" path="res://scenes/widgets/StatHud.tscn" id="10_g3b4s"]

[node name="GameSession" type="Node2D" node_paths=PackedStringArray("CurPolyomino", "NextPolyomino", "BlockBoard")]
script = ExtResource("1_8dl8f")
CurPolyomino = NodePath("CurPolyomino")
NextPolyomino = NodePath("NextPolyomino")
BlockBoard = NodePath("BlockBoard")

[node name="ColorRect" type="ColorRect" parent="."]
custom_minimum_size = Vector2(1152, 648)
offset_right = 1156.0
offset_bottom = 728.0

[node name="InputEvents" parent="." instance=ExtResource("2_a1hox")]

[node name="PlayerStateMachine" type="Node" parent="." node_paths=PackedStringArray("InitialState")]
script = ExtResource("3_3ufha")
InitialState = NodePath("PlayerStartState")

[node name="PlayerInputState" type="Node" parent="PlayerStateMachine" node_paths=PackedStringArray("_inputEvents", "GameSession")]
script = ExtResource("4_7jlcv")
_inputEvents = NodePath("../../InputEvents")
GameSession = NodePath("../..")

[node name="PlayerPlacingState" type="Node" parent="PlayerStateMachine" node_paths=PackedStringArray("GameSession")]
script = ExtResource("5_dobk6")
GameSession = NodePath("../..")

[node name="PlayerGameOverState" type="Node" parent="PlayerStateMachine" node_paths=PackedStringArray("GameSession")]
script = ExtResource("6_0tcjc")
GameSession = NodePath("../..")

[node name="PlayerStartState" type="Node" parent="PlayerStateMachine" node_paths=PackedStringArray("_inputEvents", "GameSession")]
script = ExtResource("7_d3pe8")
_inputEvents = NodePath("../../InputEvents")
GameSession = NodePath("../..")

[node name="CurPolyomino" parent="." instance=ExtResource("8_giipe")]
position = Vector2(945, 225)

[node name="NextPolyomino" parent="." instance=ExtResource("8_giipe")]
position = Vector2(945, 489)
scale = Vector2(0.7, 0.7)

[node name="BlockBoard" parent="." instance=ExtResource("9_0x3v3")]
position = Vector2(576, 324)

[node name="StatHud" parent="." instance=ExtResource("10_g3b4s")]
offset_left = 103.0
offset_top = 76.0
offset_right = 103.0
offset_bottom = 76.0

[node name="Label" type="Label" parent="."]
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = 519.0
offset_top = 87.0
offset_right = 628.0
offset_bottom = 129.0
grow_horizontal = 2
theme_override_font_sizes/font_size = 30
text = "Normal"

[connection signal="EnteredNewTurn" from="PlayerStateMachine/PlayerInputState" to="StatHud" method="OnNewTurn"]
[connection signal="BlocksRemoved" from="BlockBoard" to="StatHud" method="OnNewCombo"]
[connection signal="EnteredPhase" from="BlockBoard" to="StatHud" method="OnPhase"]
